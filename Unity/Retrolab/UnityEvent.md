# 유니티 Event

이벤트를 설명



뒤에 이벤트 , 델리 설명하는데 유니티가 사용하기 쉽게 랩핑해논 유니티 이벤트를보자



이벤트를 발동하면 등록해놓은 기능을  수행한다. 이벤트 기능 등록해서 언제 발동할지에 대해서 신경을 안쓴고 서로에게 관심이 없어



스파게티 처럼 엮이지 않음



이벤트 사용할 게임을 가정해보자



플레이어가 죽었을 때 도전과제 언락 해주고

 게임 재시작 기능을 발동하자



유니티 내장된 기능 



Assets Character 들고오자



이건 중요하지 않음 연쇄적으로 발동한다.



ThirdPersonCharacterController를 넣어주고 바닥 만들어주고



바닥 밑에 또 낭떠러지를 만들어서 닿으면 죽게하자



큐브해서 아래로 떨어뜨려서 영역을 만들어주자



붉은 색 마테리얼 붙이자 트리거 쳐서 충돌 체크하게 하자



플레이해서 조작되는지 보자!



어쨋든 낭떠러지에 떨어지면 UI 뛰어주고 게임을 재시작하고 싶어요



플레이어로 가서 미리 만들어논 스케쥴러는 신경 X

처음 설치할 때 strand 패키지 설치안하면 없음

playerHealth 스크립트를 만들어서 레드존에 닿으면 죽게 하자!





OnTriggerEnter에서 닿으면 죽었다 뛰우면 된다.

Destroy(게임 오브젝트)

로그 찍자



플레이어 죽었을 때 도전과제 죽었다고 하자 이벤트 진가 보고 싶다.

UIManager => UI에 텍슽트에 죽었다고 뛰어주자

하이라키에 유아 text 찍고 Player State Text를 뛰어주자 엥커 Alt로 쫙 펼쳐주고 센터 미들고 Best Fit으로 자동으로 커지게 하고 처음에 비워주자



플레이어 죽으면 YouDie 뛰우자



UIManager에 OnPlayerDead 에서 스테이트 텍스트 You Die 뛰어주자

세이브 하고 Player State Text 연결해주자





만약 이 함수 발동되면 You Die 뜨겠지





도전 과제 시스템을 만들어보자



AchivementSystem 스크립트 만들자  게임 로직이랑 상관없고 게임 완성된 다음에 삽입을 하는 거지!



그래서 추가적인 여흥이지



using UI 추가하고

Text achivementText 멤버 추가



UnLockAchivement 매소드 구현

떨어져 죽었으면 뉴턴의 법칙 도전과제 해결했다고 뛰어주자



마찬가지로 도전과제형 텍스트를 만들어주자

Achivement Text 마찬가지고 엥커 alt 쫙 늘려주고 우측 상단에 넣자 폰트좀 키워주고 텍스트 지워주자!



켄버스에 스크립트 적용 후 연결



플레이어가 죽었을 때 5초뒤에 재시작하자!



GameManager 생성

여기는 플레이어 죽었을 때 5초뒤에 게임 재시작하자!!

using SceneManagement



Restart

​	SceneManager.  LoadScene(0) / /0 은 현재 씬 재시작임



//플레이어가 죽었을 때 이 함수가 발동

public void OnPlayerDead()

{

​	Invoke(함수이름 , 지연 시간) // 어떤 함수를 명시해주고 지연시간을 주면 지연시간 만큼 시간이 흐르고 발동된다.

}



5초뒤에 Restart 함수 발동해서 0번쨰 씬이 재시작 되는거자





Gammanager를 위한 오브젝트 만들고 씬 넣자



게임 로직은 관심없지만 플레이어가 죽었을 때 

우리가 작성했던 UI , Achive , Game Manager 스크립트가 죽었을 때 자동으로 기능이 발동되야하는데

이벤트 없으면 스파게티처럼 꼬이게 된다.



뭔말이냐면 PlayerHealth 스크립트에서



private void Dead()

함수 만들고 OnTrigger에서 Dead 호출하자



낭떨어지 부딪혔을때 Dead가 호출될 때 UI , GameManager , Dead가 같이 발동하고 싶은거지



이벤트가 없으면 서로 알고있어야하지 즉 PlayerHealth가 UIManager , GameManager.AchivementSystem을 알아야 한다.



가져와서 Dead 함수를 발동해줘야하지

돌아가서  스크립트 각자 연결해줘야하지!!



이제 AchivementSystem은 처음부터 만들지 않고 나중에 만든다...



player는 게임 로직이지 굳이 연결될 필요도 없고, 이런 시스템이 하나하나 추가될 때마다 연결해줘야한다.



자기 체력만 챙기면 되는데 전투시스템 등등 외부 시스템을 알고있어야 한느데 

자기만 생각하고 싶고,

죽었을 때 하드하게 연결하지 않고 발동되게 하고 싶은거지. 그때 필요한게 바로 이벤트다!!



그림을 그려서 보자 로직은 보지말고



이벤트 왜 필요한지만 보면된다.



이벤트는 명단에 등록된 기능을 발동하는데 그 명단에 기능이 뭔지 관심이 없어 간단함



그래서 이것을 만들자 

이제 플레이어에서

명단에서 니들이 등록해 근데 난 니들이 뭔지 신경안씀



using Unity.Events 등록



UnityEvent onPlayerDead; // 밖에서 등록할 수 있는 이벤트 객체



Dead 호출됬을 때 등록해 분 플레이어 발동

​	onPlayerDead.Invok(); 호출하면된다ㅣ.



이제 객체 늘어나도 코드 안바뀌고 간단



버튼도 이벤트이다 이제 명단을 3개 열어두고 



연쇄적으로 발동될 기능을 등록해주면 된다.



오브젝트 드래그 드랍해서 기능 넣고 입력받으면 입력을 추가하면 됩니다.



이제 떨어져 죽을 때 발동되지 아까 와 달리 차이는

playerHeath가 다른 객체와 전혀 연관이 안되있어서 깔끔하다!!



서로 관심없어서 코드가 매우 깔끔해진다..



















